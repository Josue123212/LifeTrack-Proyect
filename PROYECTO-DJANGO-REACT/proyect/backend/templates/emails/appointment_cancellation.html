{% extends "emails/base_email.html" %}

{% block title %}CancelaciÃ³n de Cita - Sistema de Citas MÃ©dicas{% endblock %}

{% block content %}
<h2>âŒ CancelaciÃ³n de Cita MÃ©dica</h2>

<p>Estimado/a <strong>{{ patient_name }}</strong>,</p>

{% if cancelled_by_patient %}
<p>Hemos recibido su solicitud de cancelaciÃ³n y confirmamos que su cita mÃ©dica ha sido <strong>cancelada exitosamente</strong>.</p>
{% else %}
<p>Lamentamos informarle que su cita mÃ©dica ha sido <strong>cancelada</strong> {% if cancellation_reason %}debido a: <em>{{ cancellation_reason }}</em>{% endif %}.</p>
{% endif %}

<div class="appointment-details">
    <h3>ğŸ“‹ Detalles de la Cita Cancelada</h3>
    
    <div class="detail-row">
        <span class="detail-label">ğŸ‘¨â€âš•ï¸ Doctor:</span>
        <span class="detail-value">Dr. {{ doctor_name }}</span>
    </div>
    
    <div class="detail-row">
        <span class="detail-label">ğŸ¥ Especialidad:</span>
        <span class="detail-value">{{ doctor_specialty }}</span>
    </div>
    
    <div class="detail-row">
        <span class="detail-label">ğŸ“… Fecha Original:</span>
        <span class="detail-value">{{ appointment_date|date:"l, d \d\e F \d\e Y" }}</span>
    </div>
    
    <div class="detail-row">
        <span class="detail-label">ğŸ• Hora Original:</span>
        <span class="detail-value">{{ appointment_time|time:"H:i" }}</span>
    </div>
    
    <div class="detail-row">
        <span class="detail-label">ğŸ“… Fecha de CancelaciÃ³n:</span>
        <span class="detail-value">{{ cancellation_date|date:"d \d\e F \d\e Y \a \l\a\s H:i" }}</span>
    </div>
    
    {% if cancellation_reason %}
    <div class="detail-row">
        <span class="detail-label">ğŸ“ Motivo:</span>
        <span class="detail-value">{{ cancellation_reason }}</span>
    </div>
    {% endif %}
</div>

{% if not cancelled_by_patient %}
<div class="alert warning">
    <strong>âš ï¸ Disculpas por la Inconveniencia</strong><br>
    Entendemos que esta cancelaciÃ³n puede causarle molestias. Nuestro equipo estÃ¡ trabajando para 
    minimizar estas situaciones y brindarle el mejor servicio posible.
</div>
{% endif %}

{% if refund_info %}
<div class="alert info">
    <strong>ğŸ’° InformaciÃ³n de Reembolso:</strong><br>
    {{ refund_info }}
</div>
{% endif %}

{% if show_reschedule_options %}
<div class="alert success">
    <strong>ğŸ“… Â¿Desea Reprogramar?</strong><br>
    Puede programar una nueva cita de forma rÃ¡pida y sencilla utilizando nuestro sistema en lÃ­nea.
</div>

<div style="text-align: center; margin: 25px 0;">
    {% if reschedule_url %}
    <a href="{{ reschedule_url }}" class="button success">ğŸ“… Programar Nueva Cita</a>
    {% endif %}
    
    {% if available_slots_url %}
    <a href="{{ available_slots_url }}" class="button">ğŸ‘€ Ver Horarios Disponibles</a>
    {% endif %}
</div>

{% if suggested_dates %}
<div style="background-color: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
    <h4 style="margin-top: 0; color: #28a745;">ğŸ—“ï¸ Horarios Sugeridos Disponibles:</h4>
    <ul style="margin: 10px 0; padding-left: 20px;">
        {% for date in suggested_dates %}
        <li><strong>{{ date.date|date:"l, d \d\e F" }}</strong> a las <strong>{{ date.time|time:"H:i" }}</strong></li>
        {% endfor %}
    </ul>
    <p style="margin-bottom: 0; font-size: 14px; color: #666;">
        <em>Estos horarios estÃ¡n sujetos a disponibilidad al momento de la reserva.</em>
    </p>
</div>
{% endif %}
{% endif %}

{% if contact_info %}
<div style="background-color: #e3f2fd; padding: 15px; border-radius: 5px; margin: 20px 0;">
    <strong>ğŸ“ Â¿Necesita Ayuda?</strong><br>
    Si tiene alguna pregunta o necesita asistencia para reprogramar, nuestro equipo estÃ¡ aquÃ­ para ayudarle:
    <ul style="margin: 10px 0; padding-left: 20px;">
        <li><strong>TelÃ©fono:</strong> {{ contact_phone|default:"+1 (555) 123-4567" }}</li>
        <li><strong>Email:</strong> {{ contact_email|default:"citas@citasmedicas.com" }}</li>
        <li><strong>Horario:</strong> Lunes a Viernes, 8:00 AM - 6:00 PM</li>
    </ul>
</div>
{% endif %}

{% if cancelled_by_patient %}
<p>Gracias por utilizar nuestro sistema de citas. Esperamos poder atenderle en una prÃ³xima ocasiÃ³n.</p>
{% else %}
<p>Nuevamente, nos disculpamos por cualquier inconveniente causado y esperamos poder atenderle pronto.</p>
{% endif %}

<p>Atentamente,<br>
<strong>Equipo del Sistema de Citas MÃ©dicas</strong></p>

{% if feedback_url %}
<div style="text-align: center; margin-top: 25px; padding: 15px; background-color: #f1f3f4; border-radius: 5px;">
    <p style="margin: 0; font-size: 14px;">
        <strong>Su opiniÃ³n es importante para nosotros</strong><br>
        <a href="{{ feedback_url }}" style="color: #007bff; text-decoration: none;">Comparta su experiencia</a>
    </p>
</div>
{% endif %}
{% endblock %}